<!DOCTYPE html>
<html>
<head>
<style>
body{
    background: linear-gradient(180deg, #f6f7f9, #eef1f4);
    font-family: 'Times New Roman', Times, serif;
}

body{
        background: linear-gradient(180deg, #e1e2e4, #e1e2e4);
        font-family: 'Times New Roman', Times, serif;
    }
    form{
        height: 480px;
        width: 850px;
        margin: auto;
        margin-top: 50px;
        border-radius: 20px;
        background-color: white;
     
    }
    #fhead{
        height: 15%;
        width: 100%;
        background-color: #115e59;
        border-radius: 10px 10px 0px 0px;
    }
    #ContainerM{
        display: flex;
        flex-direction: row;
        justify-content: center;
        height: fit-content;
        width: 845px;
        gap: 30px;
    }
    #Container1{
       height: fit-content;
       width: 45%;
       margin-top: 20px;
       line-height: 10px;
       text-align: center;
      
    }
    #Container2{
        height: 300px;
        width: 380px;
        box-shadow: 1px 1px 1px 1px gray;
        margin-top:50px ;
        display: flex;
        flex-direction: column;
        justify-content: space-evenly;
        border-radius: 10px;
      
    }
    input{
        width: 280px;
        height: 40px;
        margin: auto;
        border-radius: 5px;
        margin-top: -10px;
    }
    button{
        background-color: #115e59;
        color: white;
         width: 280px;
        height: 40px;
        margin: auto;
        border-radius: 5px;
        font-family: 'Times New Roman', Times, serif;
        font-weight: bold;
        margin-top: -10px;
    }
    img{
        position: absolute;
        margin-top: 190px;
        margin-left: 100px;
        height: 240px;
        width: 240px;
    }
    h2{
        margin: auto;
    }
    #p1{
    justify-content: center;
    margin-left: 70px;
    margin-top: -20px;
    }

.displayCard{
    width: 850px;
    margin: 40px auto;
    border-radius: 20px;
    background-color: white;
    overflow: hidden;
    box-shadow: 0px 4px 12px rgba(0,0,0,0.15);
}

.displayHeader{
    height: 70px;
    background-color: #115e59;
    color: white;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size: 24px;
    font-weight: bold;
}

.displayBody{
    padding: 30px;
}

table{
    width:100%;
    border-collapse: collapse;
}

th{
    background:#115e59;
    color:white;
    padding:12px;
}

td{
    padding:12px;
    text-align:center;
}

tr:nth-child(even){
    background:#f6f7f9;
}

table button{
    width:auto;
    height:30px;
    padding:0 10px;
    margin:2px;
}
</style>
</head>

<body>

<body>
    <form id="form">
            <div id="logo">
    <img src="logo11.png" alt="" height="90px" width="100px" >
</div>
        <div id="fhead"> </div>
            <div id="ContainerM">

                <div id="Container1">
                    <h1>Student Scheduling System</h1>
                    <p>Sign in to manage your schedule and classes.</p>
                </div>

                

                <di id="Container2">
                    <h2>Signup</h2>
                    <input id="name" type="text" placeholder="Name">
                    <input id="email" type="email" placeholder="Email">
                    <p id="p1">Already have an account? <a href="index.html">Login</a></p>
                    <button>Signup</button>
                </div>
                
</div>

            </div>

    </form>

<script>
const form = document.getElementById('form');
form.onsubmit = async e => {
    e.preventDefault();
    const res = await fetch('http://localhost:3000/users', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({
            name: document.getElementById('name').value,
            email: document.getElementById('email').value
        })
    });

    const data = await res.json(); 

    if (res.ok) {
        alert('Data inserted successfully');
        loadUsers();
        document.getElementById('form').reset();
    } else {
        alert('Insert failed: ' + JSON.stringify(data)); 
    }
};

const getEl = id => document.getElementById(id);

function loadUsers() {
    fetch('http://localhost:3000/users/display')
        .then(response => response.json())
        .then(users => {
            getEl('tableBody').innerHTML = users.map(user => `
                <tr id="row-${user.id}">
                    <td>${user.id}</td>
                    <td id="name-${user.id}">${user.name}</td>
                    <td id="email-${user.id}">${user.email}</td>
                    <td>
                        <button onclick="editUser(${user.id})">Edit</button>
                        <button onclick="saveUser(${user.id})" id="save-${user.id}" hidden>Save</button>
                        <button onclick="cancelEdit(${user.id})" id="cancel-${user.id}" hidden>Cancel</button>
                        <button onclick="deleteUser(${user.id})" style="color:red;">Delete</button>
                    </td>
                </tr>
            `).join('');
        });
}

loadUsers();

function editUser(id) {
    getEl(`name-${id}`).innerHTML = `<input id="edit-name-${id}" value="${getEl(`name-${id}`).innerText}">`;
    getEl(`email-${id}`).innerHTML = `<input id="edit-email-${id}" value="${getEl(`email-${id}`).innerText}">`;
    
    getEl(`save-${id}`).hidden = false;
    getEl(`cancel-${id}`).hidden = false;
}

async function saveUser(id) {
    const response = await fetch(`http://localhost:3000/users/${id}`, {
        method: 'PATCH',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({
            name: getEl(`edit-name-${id}`).value,
            email: getEl(`edit-email-${id}`).value
        })
    });

    const user = await response.json();
    getEl(`name-${id}`).innerHTML = user.name;
    getEl(`email-${id}`).innerHTML = user.email;
    getEl(`save-${id}`).hidden = true;
    getEl(`cancel-${id}`).hidden = true;

    alert('User updated!');
}

function cancelEdit(id) {
    fetch(`http://localhost:3000/users/${id}`)
        .then(response => response.json())
        .then(user => {
            getEl(`name-${id}`).innerHTML = user.name;
            getEl(`email-${id}`).innerHTML = user.email;
            getEl(`save-${id}`).hidden = true;
            getEl(`cancel-${id}`).hidden = true;
        });
}

async function deleteUser(id) {
    if (!confirm('Are you sure you want to delete this user?')) return;
    
    await fetch(`http://localhost:3000/users/${id}`, { method: 'DELETE' });

    getEl(`row-${id}`).remove();
    alert('User deleted successfully!');
}
</script>

</body>
</html>
