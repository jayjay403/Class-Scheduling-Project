<!DOCTYPE html>
<html>
<head>
<style>
body{
        background: linear-gradient(180deg, #e1e2e4, #e1e2e4);
        font-family: 'Times New Roman', Times, serif;
    }
    form{
        height: 480px;
        width: 850px;
        margin: auto;
        margin-top: 50px;
        border-radius: 20px;
        background-color: white;
    }
    #fhead{
        height: 15%;
        width: 100%;
        background-color: #115e59;
        border-radius: 10px 10px 0px 0px;
    }
    #ContainerM{
        display: flex;
        flex-direction: row;
        justify-content: center;
        height: fit-content;
        width: 845px;
        gap: 30px;
    }
    #Container1{
       height: fit-content;
       width: 45%;
       margin-top: 20px;
       line-height: 10px;
       text-align: center;
    }
    #Container2{
        height: 320px;
        width: 380px;
        box-shadow: 1px 1px 1px 1px gray;
        margin-top:50px ;
        display: flex;
        flex-direction: column;
        justify-content: space-evenly;
        border-radius: 10px;
        padding: 10px 0;
    }
    input{
        width: 280px;
        height: 40px;
        margin: auto;
        border-radius: 5px;
        margin-top: 0px;
    }
    button{
        background-color: #115e59;
        color: white;
        width: 280px;
        height: 40px;
        margin: auto;
        border-radius: 5px;
        font-family: 'Times New Roman', Times, serif;
        font-weight: bold;
        margin-top: 0px;
        cursor: pointer;
    }
    img{
        position: absolute;
        margin-top: 190px;
        margin-left: 100px;
        height: 240px;
        width: 240px;
    }
    h2{
        margin: auto;
    }
    #p1{
        justify-content: center;
        margin-left: 70px;
        margin-top: 0px;
    }
    #errorMsg{
        color: red;
        text-align: center;
        font-size: 13px;
        margin: 0 auto;
        padding: 0 10px;
        display: none;
    }
</style>
</head>
<body>
    <form>
        <div id="logo">
            <img src="logo11.png" alt="" height="90px" width="100px">
        </div>
        <div id="fhead"></div>
        <div id="ContainerM">
            <div id="Container1">
                <h1>Class Scheduling System</h1>
                <p>Sign in to manage your schedule and classes.</p>
            </div>
            <div id="Container2">
                <h2>Login</h2>
                <input id="username" type="text" placeholder="Name">
                <input id="password" type="email" placeholder="Email">
                <p id="errorMsg">Name or Email not found. Please sign up first.</p>
                <p id="p1">Doesn't have any account? <a href="index2.html">Signup</a></p>
                <button type="button" onclick="login()">Login</button>
            </div>
        </div>
    </form>

<script>
    async function login() {
        const name = document.getElementById('username').value.trim();
        const email = document.getElementById('password').value.trim();
        const errorMsg = document.getElementById('errorMsg');
        errorMsg.style.display = 'none';

        if (!name || !email) {
            alert('Please enter both Name and Email.');
            return;
        }

        try {
            // Check if user exists in the database
            const res = await fetch('/users/display');
            const users = await res.json();

            const found = users.find(u =>
                u.name.toLowerCase() === name.toLowerCase() &&
                u.email.toLowerCase() === email.toLowerCase()
            );

            if (found) {
                localStorage.setItem('loggedIn', 'true');
                localStorage.setItem('userName', found.name);
                location.href = 'dash.html';
            } else {
                errorMsg.style.display = 'block';
            }
        } catch (err) {
            alert('Error connecting to server. Please try again.');
        }
    }
</script>
</body>
</html>